# Задание 2. Мониторинг

## Мотивация (основание для бизнеса)
Мониторинг позволяет узнавать о проблемах сервисов не от пользователей, что может привести
к репутационным рискам, а заранее. Тем самым сохранить доверие пользователей к продукту.
Еще одна причина, это повышение быстро действия системы и правильное распределение
ресурсов. При помощи мониторинга можно заметить какие части системы самые нагруженные и какие ресурсы
используются не эффективно. Использовав ресурсы эффективно, мы можем сохранить деньги нашему бизнесу,
которые можно будет потратить на маркетинг, для привлечения новых пользователей.


## Выбор подхода к мониторингу
В нашей системе есть 3 основных сервиса
1. Онлайн-магазин
2. CRM
3. MES

Для MES я бы попробовал использовать USE. Таким способом можно было бы определить ЕС2 инстансы, где
не хватало ресурсов, для обработки сложных изделий(множество полигонов). Тут можно было бы еще докинуть
RED, для понимания здоровья самого сервиса.
Для Онлайн-магазина и CRM системы кажется лучшим вариантом для мониторинга будет RED.

## Какие метрики и в каких частях системы
**RabbitMQ**
- Number of dead-letter-exchange letters in RabbitMQ
- Number of message in flight in RabbitMQ
- Number of ready message in queue
- Total message count
- Consumer Count
- Memory Utilisation
- Message publishing rate

**MES**
- Number of requests (RPS) for MES API
- Number of requests (RPS) per user for MES API
- CPU % for MES API
- Memory Utilisation for MES API
- Number of simultanious sessions for MES API
- Errors rate (500)
- Response status distribution
- Response time (latency) for MES API
- Number of connections for MES db instance
- Size of S3 storage
- Size of MES db instance
- Indexes size
- Commit latency
- Query rate
- Bytes In-Out transfer to DB

**CRM**
- Number of requests (RPS) for CRM API
- CPU % for CRM API
- Memory Utilisation for CRM API
- Response time (latency) for CRM API
- Number of HTTP 500 for CRM API
- Kb tranferred (received) for CRM API

**Онлайн-магазин**
- Number of requests (RPS) for internet shop API
- Number of requests (RPS) per user for internet shop API
- CPU % for shop API
- Memory Utilisation for shop API
- Number of connections for shop db instance
- Response time (latency) for shop API
- Size of shop db instance
- Number of HTTP 500 for shop API
- Number of simultanious sessions for shop API
- Kb tranferred (received) for shop API

## План действий
Так как мы уже находимся в клауде, часть метрик можно получить от туда. Дальше, нужно будет поднять
Prometeous для хранения метрик специфичных для системы. Настроить агенты экспортеры для Яндекс Клауда и 
остальных сервисов. Вывести метрики по каждому сервису в Grafana